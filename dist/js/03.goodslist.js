"use strict";require.config({paths:{jquery:"../lib/js/jquery-1.10.1.min",common:"common"},shim:{}}),require(["jquery","common"],function(f){f(function(){if(f(window).bind("scroll resize",function(){f(window).width();400<f(window).scrollTop()?f("#toTop").slideDown("slow"):f("#toTop").slideUp("slow")}),f(".gocart").click(function(){(console.log("x"),getcookie("name"))?location.href="../html/cart.html":confirm("请登录")&&(location.href="../html/login.html")}),function(){if(getcookie("name"))f.ajax({type:"get",url:"../api/index.php",data:"username="+getcookie("name"),success:function(a){var s=JSON.parse(a);if(console.log(s),s.tiao){for(var n=s.zongtiao[0]["sum(counts)"],i=0,e=0;e<s.biao.length;e++)i+=s.biao[e].counts*s.biao[e].dmoney;console.log(i);var t='<div class="zlc">\n                                    共<b>'+s.zongtiao[0]["sum(counts)"]+"</b>件商品　共计<strong>￥"+i+'.00</strong><br>\n                                    <a title="去结算" href="cart.html">去结算<em></em></a>\n                                    <input type="hidden" id="shopcartPatternForMini" value="gouwu">\n                                </div>',o=s.biao.map(function(a){return'<li>\n                                    <div class="w-img fl">\n                                        <a href="###">\n                                            <img src="'+a.dimg+'" width="50" height="50">\n                                        </a>\n                                    </div>\n                                    <div class="w-tit fl">\n                                        <div class="nk" style="height: 50px;">\n                                            <a href="###"> '+a.dgoodsname+'</a>\n                                            <a href="#" title="" class="orange" style="font-weight: bold;"> </a><br> <br>\n                                        </div>\n                                    </div>\n                                    <div class="w-sale fl">\n                                        <span id="sum61647-0" class="sum">'+a.dmoney+'.00</span>\n                                    </div>\n                                    <div class="w-detail fr">\n                                        <div class="asub">\n                                            <a data-id="'+a.huohao+'" href="###" class="jianhao"></a>\n                                            <input data-id="'+a.huohao+'" class="zhi" min-amount="1" type="text" value="'+a.counts+'">\n                                            <a href="###" class="jiahao" data-id="'+a.huohao+'"></a>\n                                        </div>\n                                        <a data-id="'+a.huohao+'" href="###" class="delete">删除</a>\n                                    </div>\n                                </li>'}).join("");f("#shopcarDiv .zlb").html(f("<ul></ul>").append(o)),f("#shopcarDiv").append(t),f("#cartCount").html(n),f(".jiahao").click(function(){var a=0,s=0,n=f(this).prev().val();n++,f(this).prev().val(n);for(var i=0;i<f(".zlb ul li").size();i++)a+=f(".jiahao").eq(i).parent().parent().prev().find(".sum").html()*f(".jiahao").eq(i).prev().val(),s+=1*f(".jiahao").eq(i).prev().val();f(".zlc strong").html("￥"+a+".00"),f(".zlc b").html(s),f("#cartCount").html(s),f.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+f(this).attr("data-id")+"&vall="+n,success:function(a){console.log(a)}})}),f(".jianhao").click(function(){var a=0,s=0,n=f(this).next().val();--n<=1&&(n=1),f(this).next().val(n);for(var i=0;i<f(".zlb ul li").size();i++)a+=f(".jianhao").eq(i).parent().parent().prev().find(".sum").html()*f(".jianhao").eq(i).next().val(),s+=1*f(".jiahao").eq(i).prev().val();f(".zlc strong").html("￥"+a+".00"),f(".zlc b").html(s),f("#cartCount").html(s),f.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+f(this).attr("data-id")+"&vall="+n,success:function(a){console.log(a)}})}),f(".zhi").blur(function(){for(var a=0,s=0,n=0;n<f(".zlb ul li").size();n++)a+=f(".zhi").eq(n).parent().parent().prev().find(".sum").html()*f(".zhi").eq(n).val(),s+=1*f(".jiahao").eq(n).prev().val();console.log(f(this).val()),f(".zlc strong").html("￥"+a+".00"),f(".zlc b").html(s),f("#cartCount").html(s),f.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+f(this).attr("data-id")+"&vall="+f(this).val(),success:function(a){console.log(a)}})}),f(".delete").click(function(){f(this).parent().parent().remove();for(var a=0,s=0,n=0;n<f(".zlb ul li").size();n++)a+=f(".zhi").eq(n).parent().parent().prev().find(".sum").html()*f(".zhi").eq(n).val(),s+=1*f(".jiahao").eq(n).prev().val();f(".zlc strong").html("￥"+a+".00"),f(".zlc b").html(s),f("#cartCount").html(s),f.ajax({type:"get",url:"../api/indexdel.php",data:"username="+getcookie("name")+"&huohao="+f(this).attr("data-id"),success:function(a){if(0==a){f("#shopcarDiv .zlb").html('<div class="zla">\n                                        <em class="gwico"></em>\n                                        购物车空空如也，赶紧选购吧!\n                                    </div>'),f("#cartCount").html("0"),f(".zlc").remove()}}})})}else{f("#shopcarDiv .zlb").html('<div class="zla">\n                        <em class="gwico"></em>\n                        购物车空空如也，赶紧选购吧!\n                    </div>'),f("#cartCount").html("0")}}});else{f("#shopcarDiv .zlb").html('<div class="zla">\n                        <em class="gwico"></em>\n                        购物车空空如也，赶紧选购吧!\n                    </div>'),f("#cartCount").html("0")}}(),f(".logo_rc").hover(function(){f(this).addClass("act"),f("#shopcarDiv").css("display","block")},function(){f(this).removeClass("act"),f("#shopcarDiv").css("display","none")}),f("#shopcarDiv").hover(function(){f(this).css("display","block"),f(".logo_rc").addClass("act")},function(){f(this).css("display","none"),f(".logo_rc").removeClass("act")}),getcookie("name")){var a=getcookie("name");f("#dengluhou").html("您好，"+a+"欢迎来到健一网网上药店!<a id='tc' href='../index1.html'>退出</a>")}else f("#dengluhou").html('欢迎来到健一网<h1>网上药店</h1>！[ <a href="login.html">登录</a> ] [ <a href="register.html">注册</a> ]');f("#tc").click(function(){removecookie("name"),location.href="../index1.html"}),f("#goodsfenlei").hover(function(){f("#nav2").css("display","block")},function(){f("#nav2").css("display","none")}),f(".nav2 .list").hover(function(){f("#nav2").css("display","block")},function(){f("#nav2").css("display","none")});var s=f(".yqlj .tempWarp ul li").css("height").split("p")[0];f(".yqlj .tempWarp ul").css("height",4*s+"px");var d,r,n=setInterval(e,2500),i=0;function e(){4<=++i&&(f(".yqlj .tempWarp ul").css("top",-s+"px"),i=2),f(".yqlj .tempWarp ul").animate({top:-s*i},500,"linear")}f(".yqlj .tempWarp ul li").hover(function(){clearInterval(n)},function(){n=setInterval(e,2500)});var t=!0,o=!0,l=!0,c=!0,p="",h="",g="",m="",u="";function v(a){var s=a.yes,n=void 0===s?1:s,i=a.type,e=void 0===i?"":i,t=a.order,o=void 0===t?"":t,l=(a.min,a.max,a.kuang),c=void 0===l?"":l;d=n,f.ajax({type:"get",url:"../api/05.goodslist.php",data:"hang=28&ye="+d+"&type="+e+"&order="+o+"&kuang="+c,success:function(a){var i=JSON.parse(a);console.log(i),f(".main_r_m").html("");for(var s=0;s<i.zong;s++)if(f(".listsearch-jg").size()){var n=f(".listsearch-jg").size();if(f(".listsearch-jg:eq("+(n-1)+") .listsearch-one").size()<4){var e='<div class="listsearch-one">\n                                <div class="listsearch-ztimg">\n                                    '+i.goodslist[s].goodsong+'\n                                    <center>\n                                        <a href="###">\n                                            <img data-id="'+i.goodslist[s].sid+'" src="'+i.goodslist[s].goodsimg+'" height="200" width="200" alt="" />\n                                        </a>\n                                    </center>\n                                </div>\n                                <div class="listsearch-cx">                               \n                                </div>\n                                <div class="listsearch-mc">\n                                    <a data-id="'+i.goodslist[s].sid+'" href="###">\n                                         '+i.goodslist[s].goodscanshu+'\n                                    </a>\n                                </div>\n                                <div class="listsearch-price">\n                                    <span class="liststyle2">¥'+i.goodslist[s].goodsmoney+'</span>\n                                </div>\n                                <div class="listsearch-des">\n                                    <span>总销量：'+i.goodslist[s].goodsale+'</span>\n                                    <a href="###">\n                                        '+i.goodslist[s].goodspl+'条评论\n                                    </a>\n                                </div>\n                                <div class="listsearch-xq">\n                                    <div class="listshop">\n                                        <a class="jrcart" data-id="'+i.goodslist[s].sid+'" href="###">\n                                            <span class="shopnow"></span>\n                                            <cite>加入购物车</cite>\n                                        </a>\n                                    </div>\n                                    <div class="listcheck">\n                                        <a data-id="'+i.goodslist[s].sid+'" href="###">查看详情</a>\n                                    </div>\n                                </div>\n                            </div>';f(".listsearch-jg").eq(f(".listsearch-jg").size()-1).append(e)}else{f(".main_r_m").append("<div class='listsearch-jg'></div>");var t='<div class="listsearch-one">\n                                <div class="listsearch-ztimg">\n                                    '+i.goodslist[s].goodsong+'\n                                    <center>\n                                        <a href="###">\n                                            <img src="'+i.goodslist[s].goodsimg+'" height="200" width="200" alt="" />\n                                        </a>\n                                    </center>\n                                </div>\n                                <div class="listsearch-cx">                               \n                                </div>\n                                <div class="listsearch-mc">\n                                    <a href="###">\n                                         '+i.goodslist[s].goodscanshu+'\n                                    </a>\n                                </div>\n                                <div class="listsearch-price">\n                                    <span class="liststyle2">¥'+i.goodslist[s].goodsmoney+'</span>\n                                </div>\n                                <div class="listsearch-des">\n                                    <span>总销量：'+i.goodslist[s].goodsale+'</span>\n                                    <a href="###">\n                                        '+i.goodslist[s].goodspl+'条评论\n                                    </a>\n                                </div>\n                                <div class="listsearch-xq">\n                                    <div class="listshop">\n                                        <a class="jrcart" data-id="'+i.goodslist[s].sid+'" href="###">\n                                            <span class="shopnow"></span>\n                                            <cite>加入购物车</cite>\n                                        </a>\n                                    </div>\n                                    <div class="listcheck">\n                                        <a href="###">查看详情</a>\n                                    </div>\n                                </div>\n                            </div>';f(".listsearch-jg").eq(f(".listsearch-jg").size()-1).html(t)}}else{f(".main_r_m").append("<div class='listsearch-jg'></div>");t='<div class="listsearch-one">\n                                        <div class="listsearch-ztimg">\n                                            '+i.goodslist[0].goodsong+'\n                                            <center>\n                                                <a href="###">\n                                                    <img data-id="'+i.goodslist[s].sid+'" src="'+i.goodslist[0].goodsimg+'" height="200" width="200" alt="" />\n                                                </a>\n                                            </center>\n                                        </div>\n                                        <div class="listsearch-cx">                               \n                                        </div>\n                                        <div class="listsearch-mc">\n                                            <a data-id="'+i.goodslist[s].sid+'" href="###">\n                                                 '+i.goodslist[0].goodscanshu+'\n                                            </a>\n                                        </div>\n                                        <div class="listsearch-price">\n                                            <span class="liststyle2">¥'+i.goodslist[0].goodsmoney+'</span>\n                                        </div>\n                                        <div class="listsearch-des">\n                                            <span>总销量：'+i.goodslist[0].goodsale+'</span>\n                                            <a href="###">\n                                                '+i.goodslist[0].goodspl+'条评论\n                                            </a>\n                                        </div>\n                                        <div class="listsearch-xq">\n                                            <div class="listshop">\n                                                <a class="jrcart" data-id="'+i.goodslist[s].sid+'" href="###">\n                                                    <span class="shopnow"></span>\n                                                    <cite>加入购物车</cite>\n                                                </a>\n                                            </div>\n                                            <div class="listcheck">\n                                                <a data-id="'+i.goodslist[s].sid+'" href="###">查看详情</a>\n                                            </div>\n                                        </div>\n                                    </div>';f(".listsearch-jg").html(t)}f(".jrcart").click(function(){var a=f(this).parent().parent().parent().parent().index(),s=f(this).parent().parent().parent().index()+4*a,n=i.goodslist[s].goodscanshu.split(" ")[0];getcookie("name")?f.ajax({type:"get",url:"../api/07.goodsDetail.php",data:"username="+getcookie("name")+"&dimg="+i.goodslist[s].goodsimg+"&dgoodsname="+n+"&huohao="+f(this).attr("data-id")+"&guige="+i.goodslist[s].goodscanshu+"&changjia="+i.goodslist[s].changjia+"&dmoney="+i.goodslist[s].goodsmoney+"&counts=1",success:function(){location.href="cart.html"}}):confirm("请登录")&&(location.href="login.html")});var o=Math.ceil(i.total/28);r=o,f(".pagenav span").html("共"+i.total+"个商品"),f(".pagenav cite").html(d+"/"+o),1==o?f(".pagenav a").addClass("disabled"):2==o&&(1==d?(f(".pagenav a").removeClass("disabled"),f(".pagenav a").eq(0).addClass("disabled")):2==d&&(f(".pagenav a").removeClass("disabled"),f(".pagenav a").eq(1).addClass("disabled")));t="共"+i.total+"条:";1==o?(t+='<span class="disabled">首页</span>\n                    <span class="disabled">上一页</span>\n                    <span class="current">1</span>\n                    <span class="disabled">下一页</span>\n                    <span class="disabled">末页</span>',f(".page-bottom").html(t)):2==o&&(1==i.page?(t+='<span class="disabled">首页</span>\n                        <span class="disabled">上一页</span>\n                        <span class="current"> 1</span>\n                        <span> <a id="dqy" href="###">2</a></span>\n                        <span id="next"> <a href="###">下一页</a></span>\n                        <span id="my"><a href="###">末页</a></span>',f(".page-bottom").html(t)):2==i.page&&(t+='<span id="sy"><a href="###">首页</a></span>\n                        <span id="prev"><a href="###">上一页</a></span>\n                        <span><a id="dqy" href="###">1</a></span>\n                        <span class="current">2</span>\n                        <span class="disabled">下一页</span>\n                        <span class="disabled">末页</span>',f(".page-bottom").html(t))),f(".listcheck a").click(function(){window.open("goodsDetail.html?"+f(this).attr("data-id"))}),f(".listsearch-mc a").click(function(){window.open("goodsDetail.html?"+f(this).attr("data-id"))}),f(".listsearch-ztimg img").click(function(){window.open("goodsDetail.html?"+f(this).attr("data-id"))})}})}v({}),f(".px dd a").eq(0).click(function(){f(".px dd a").removeClass("current"),f(this).addClass("current"),f(".px dd a span").css("background-position","-92px -32px"),t?(f(this).find("span").css("background-position","-92px 6px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodsale",order:h="desc"})):(f(this).find("span").css("background-position","-92px -13px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodsale",order:h="asc"})),t=!t,c=l=o=!0}),f(".px dd a").eq(1).click(function(){f(".px dd a").removeClass("current"),f(this).addClass("current"),f(".px dd a span").css("background-position","-92px -32px"),o?(f(this).find("span").css("background-position","-92px 6px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodspl",order:h="desc"})):(f(this).find("span").css("background-position","-92px -13px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodspl",order:h="asc"})),o=!o,c=l=t=!0}),f(".px dd a").eq(2).click(function(){f(".px dd a").removeClass("current"),f(this).addClass("current"),f(".px dd a span").css("background-position","-92px -32px"),l?(f(this).find("span").css("background-position","-92px 6px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodsmoney",order:h="desc"})):(f(this).find("span").css("background-position","-92px -13px"),v({yes:1,min:g,max:m,kuang:u="",type:p="goodsmoney",order:h="asc"})),l=!l,c=o=t=!0}),f(".px dd a").eq(3).click(function(){f(".px dd a").removeClass("current"),f(this).addClass("current"),f(".px dd a span").css("background-position","-92px -32px"),c?f(this).find("span").css("background-position","-92px 6px"):f(this).find("span").css("background-position","-92px -13px"),v({yes:1,min:g,max:m,kuang:u=h=p="",type:p,order:h}),c=!c,o=l=t=!0}),f(".pagenav a").eq(0).click(function(){--d<=1&&(d=1),v({yes:d,min:g,max:m,kuang:u,type:p,order:h})}),f(".pagenav a").eq(1).click(function(){2<=++d&&(d=2),v({yes:d,min:g,max:m,kuang:u,type:p,order:h})}),f(".get-page .get_input").keyup(function(){2<=f(".get-page .get_input").val()?f(".get-page .get_input").val("2"):f(".get-page .get_input").val()<=1&&f(".get-page .get_input").val("1")}),f(".get-page .btn").click(function(){v({yes:d=f(".get-page .get_input").val(),min:g,max:m,kuang:u,type:p,order:h})}),f("#search").click(function(){u=f("#kuang").val(),v({yes:d,min:g,max:m,kuang:u,type:p="",order:h=""})}),f(".page-bottom").on("click","#dqy",function(){v({yes:d=f(this).html(),min:g,max:m,kuang:u,type:p,order:h})}),f(".page-bottom").on("click","#next",function(){v({yes:++d,min:g,max:m,kuang:u,type:p,order:h})}),f(".page-bottom").on("click","#prev",function(){v({yes:--d,min:g,max:m,kuang:u,type:p,order:h})}),f(".page-bottom").on("click","#sy",function(){v({yes:d=1,min:g,max:m,kuang:u,type:p,order:h})}),f(".page-bottom").on("click","#my",function(){v({yes:d=r})})})});