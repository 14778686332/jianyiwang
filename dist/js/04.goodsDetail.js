"use strict";require.config({paths:{jquery:"../lib/js/jquery-1.10.1.min",common:"common"},shim:{}}),require(["jquery","common"],function(c){c(function(){function l(){if(getcookie("name"))c("#shopcarDiv .zlb").html(""),c("#shopcarDiv .zlc").remove(),c.ajax({type:"get",url:"../api/index.php",data:"username="+getcookie("name"),success:function(n){var a=JSON.parse(n);if(console.log(a),a.tiao){for(var t=a.zongtiao[0]["sum(counts)"],o=0,s=0;s<a.biao.length;s++)o+=a.biao[s].counts*a.biao[s].dmoney;console.log(o);var i='<div class="zlc">\n                                    共<b>'+a.zongtiao[0]["sum(counts)"]+"</b>件商品　共计<strong>￥"+o+'.00</strong><br>\n                                    <a title="去结算" href="cart.html">去结算<em></em></a>\n                                    <input type="hidden" id="shopcartPatternForMini" value="gouwu">\n                                </div>',e=a.biao.map(function(n){return'<li>\n                                    <div class="w-img fl">\n                                        <a href="###">\n                                            <img src="'+n.dimg+'" width="50" height="50">\n                                        </a>\n                                    </div>\n                                    <div class="w-tit fl">\n                                        <div class="nk" style="height: 50px;">\n                                            <a href="###"> '+n.dgoodsname+'</a>\n                                            <a href="#" title="" class="orange" style="font-weight: bold;"> </a><br> <br>\n                                        </div>\n                                    </div>\n                                    <div class="w-sale fl">\n                                        <span id="sum61647-0" class="sum">'+n.dmoney+'.00</span>\n                                    </div>\n                                    <div class="w-detail fr">\n                                        <div class="asub">\n                                            <a data-id="'+n.huohao+'" href="###" class="jianhao"></a>\n                                            <input data-id="'+n.huohao+'" class="zhi" min-amount="1" type="text" value="'+n.counts+'">\n                                            <a href="###" class="jiahao" data-id="'+n.huohao+'"></a>\n                                        </div>\n                                        <a data-id="'+n.huohao+'" href="###" class="delete">删除</a>\n                                    </div>\n                                </li>'}).join("");c("#shopcarDiv .zlb").html(c("<ul></ul>").append(e)),c("#shopcarDiv").append(i),c("#cartCount").html(t),c(".jiahao").click(function(){var n=0,a=0,t=c(this).prev().val();t++,c(this).prev().val(t);for(var o=0;o<c(".zlb ul li").size();o++)n+=c(".jiahao").eq(o).parent().parent().prev().find(".sum").html()*c(".jiahao").eq(o).prev().val(),a+=1*c(".jiahao").eq(o).prev().val();c(".zlc strong").html("￥"+n+".00"),c(".zlc b").html(a),c("#cartCount").html(a),c.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+c(this).attr("data-id")+"&vall="+t,success:function(n){console.log(n)}})}),c(".jianhao").click(function(){var n=0,a=0,t=c(this).next().val();--t<=1&&(t=1),c(this).next().val(t);for(var o=0;o<c(".zlb ul li").size();o++)n+=c(".jianhao").eq(o).parent().parent().prev().find(".sum").html()*c(".jianhao").eq(o).next().val(),a+=1*c(".jiahao").eq(o).prev().val();c(".zlc strong").html("￥"+n+".00"),c(".zlc b").html(a),c("#cartCount").html(a),c.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+c(this).attr("data-id")+"&vall="+t,success:function(n){console.log(n)}})}),c(".zhi").blur(function(){for(var n=0,a=0,t=0;t<c(".zlb ul li").size();t++)n+=c(".zhi").eq(t).parent().parent().prev().find(".sum").html()*c(".zhi").eq(t).val(),a+=1*c(".jiahao").eq(t).prev().val();console.log(c(this).val()),c(".zlc strong").html("￥"+n+".00"),c(".zlc b").html(a),c("#cartCount").html(a),c.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+c(this).attr("data-id")+"&vall="+c(this).val(),success:function(n){console.log(n)}})}),c(".delete").click(function(){c(this).parent().parent().remove();for(var n=0,a=0,t=0;t<c(".zlb ul li").size();t++)n+=c(".zhi").eq(t).parent().parent().prev().find(".sum").html()*c(".zhi").eq(t).val(),a+=1*c(".jiahao").eq(t).prev().val();c(".zlc strong").html("￥"+n+".00"),c(".zlc b").html(a),c("#cartCount").html(a),c.ajax({type:"get",url:"../api/indexdel.php",data:"username="+getcookie("name")+"&huohao="+c(this).attr("data-id"),success:function(n){if(0==n){c("#shopcarDiv .zlb").html('<div class="zla">\n                                        <em class="gwico"></em>\n                                        购物车空空如也，赶紧选购吧!\n                                    </div>'),c("#cartCount").html("0"),c(".zlc").remove()}}})})}else{c("#shopcarDiv .zlb").html('<div class="zla">\n                        <em class="gwico"></em>\n                        购物车空空如也，赶紧选购吧!\n                    </div>'),c("#cartCount").html("0")}}});else{c("#shopcarDiv .zlb").html('<div class="zla">\n                        <em class="gwico"></em>\n                        购物车空空如也，赶紧选购吧!\n                    </div>'),c("#cartCount").html("0")}}if(c(".gocart").click(function(){(console.log("x"),getcookie("name"))?location.href="../html/cart.html":confirm("请登录")&&(location.href="../html/login.html")}),l(),c(".logo_rc").hover(function(){c(this).addClass("act"),c("#shopcarDiv").css("display","block")},function(){c(this).removeClass("act"),c("#shopcarDiv").css("display","none")}),c("#shopcarDiv").hover(function(){c(this).css("display","block"),c(".logo_rc").addClass("act")},function(){c(this).css("display","none"),c(".logo_rc").removeClass("act")}),getcookie("name")){var n=getcookie("name");c("#dengluhou").html("您好，"+n+"欢迎来到健一网网上药店!<a id='tc' href='index1.html'>退出</a>")}else c("#dengluhou").html('欢迎来到健一网<h1>网上药店</h1>！[ <a href="login.html">登录</a> ] [ <a href="register.html">注册</a> ]');c("#tc").click(function(){removecookie("name"),location.href="index1.html"}),c("#goodsfenlei").hover(function(){c("#nav2").css("display","block")},function(){c("#nav2").css("display","none")}),c(".nav2 .list").hover(function(){c("#nav2").css("display","block")},function(){c("#nav2").css("display","none")});var a=c(".yqlj .tempWarp ul li").css("height").split("p")[0];c(".yqlj .tempWarp ul").css("height",4*a+"px");var t=setInterval(s,2500),o=0;function s(){4<=++o&&(c(".yqlj .tempWarp ul").css("top",-a+"px"),o=2),c(".yqlj .tempWarp ul").animate({top:-a*o},500,"linear")}c(".yqlj .tempWarp ul li").hover(function(){clearInterval(t)},function(){t=setInterval(s,2500)});var i=decodeURI(location.search).slice(1);c.get("../api/06.goodsDetail.php","sid="+i,function(n){var a=JSON.parse(n),t=a.list[0].goodscanshu.split(" ")[0];console.log(t);var o='<div class="main_b_l">\n                        <div id="picture">\n                            <p id="show"><span id="rev"></span></p>\n                            <p id="show1"><span id="rev1"></span></p>\n                            <span id="prev"><img src="https://cj.j1.com/images/listpage/product/left.jpg"></span>\n                            <span id="next"><img src="https://cj.j1.com/images/listpage/product/right.jpg" id="play_next"></span>\n                            <div id="xiao">\n                                <ul class="clearfix">\n                                    <li>\n                                        <a href="###">\n                                            <img src="'+a.list[0].goodsimg+'" height="58" width="58" alt="" />\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href="###">\n                                            <img src="../img/goodsDetail/3508_1_100x100.jpg" height="58" width="58" alt="" />\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href="###">\n                                            <img src="../img/goodsDetail/3508_2_100x100.jpg" height="58" width="58" alt="" />\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href="###">\n                                            <img src="../img/goodsDetail/3508_3_100x100.jpg" height="58" width="58" alt="" />\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href="###">\n                                            <img src="../img/goodsDetail/3508_4_100x100.jpg" height="58" width="58" alt="" />\n                                        </a>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="main_b_r">\n                        <div class="biaoti">\n                            <h1>'+a.list[0].goodscanshu+' </h1>\n                        </div>\n                        <div id="content">\n                            <div class="content">\n                                <div class="content_t">\n                                    <dl class="bgf7 clearfix">\n                                        <dt>价&nbsp;&nbsp;&nbsp;&nbsp;格：</dt>\n                                        <dd>\n                                            <b>￥'+a.list[0].goodsmoney+'</b>\n                                        </dd>\n                                    </dl>\n                                    <dl class="clearfix">\n                                        <dt>商品规格：</dt>\n                                        <dd id="canshu">'+a.list[0].goodscanshu+'</dd>\n                                    </dl>\n                                    <dl class="clearfix">\n                                        <dt>生产厂家：</dt>\n                                        <dd>'+a.list[0].changjia+'</dd>\n                                    </dl>\n                                    <dl class="clearfix">\n                                        <dt>支&nbsp;&nbsp;&nbsp;&nbsp;持：</dt>\n                                        <dd>支持在线支付满89元包邮</dd>\n                                    </dl>\n                                </div>\n                                <div class="content_b">\n                                    <div class="newbuywrap">\n                                        <dl class="xzys clearfix">\n                                            <dt>选择规格：</dt>\n                                            <dd>\n                                                <ul>\n                                                    <li>\n                                                        <a href="###">'+a.list[0].goodscanshu+'</a>\n                                                        <i></i>\n                                                    </li>\n                                                    <li>\n                                                        <a href="###">\n                                                            '+t+' 300片\n                                                        </a>\n                                                        <i></i>\n                                                    </li>\n                                                    <li>\n                                                        <a href="###">\n                                                            '+t+'胶囊100粒\n                                                        </a>\n                                                        <i></i>\n                                                    </li>\n                                                    <li>\n                                                        <a href="###">'+t+'100粒+大豆磷脂100粒</a>\n                                                        <i></i>\n                                                    </li>\n                                                </ul>\n                                            </dd>\n                                        </dl>\n                                        <dl id="buyNumDL" class="clearfix">\n                                            <dt class="pt5">数量：</dt>\n                                            <dd>\n                                                <input id="goodscount" class="count" value="1" type="text" name="goodscount">\n                                                <a href="###" class="c02"></a>\n                                                <a href="###" class="c01"></a>\n                                                <a href="###" rel="nofollow" id="addShopCart" class="c03"></a>\n                                            </dd>\n                                        </dl>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>';c(".main_b").html(o),c("#addShopCart").click(function(){if(getcookie("name")){console.log(c("#canshu").html()),console.log(c("#show").css("backgroundImage").split('"')[1]),console.log(a.list[0].goodsmoney),console.log(c("#goodscount").val());var n=a.list[0].goodsmoney*c("#goodscount").val();c("#sumcounts").html(c("#goodscount").val()),c("#sku_show").prev().html(c("#canshu").html()),c("#add-img").attr("src",c("#show").css("backgroundImage").split('"')[1]),c("#counts").html(c("#goodscount").val()),c("#sumPrice").html(n),c("#shopCartMessage").css("display","block"),c.ajax({type:"get",url:"../api/07.goodsDetail.php",data:"username="+getcookie("name")+"&dimg="+c("#show").css("backgroundImage").split('"')[1]+"&dgoodsname="+t+"&huohao="+a.list[0].sid+"&guige="+c("#canshu").html()+"&changjia="+a.list[0].changjia+"&dmoney="+a.list[0].goodsmoney+"&counts="+c("#goodscount").val(),success:function(){l()}})}else{confirm("请登录")&&(location.href="../html/login.html")}}),c("#messageCancelBtn").click(function(){c("#shopCartMessage").css("display","none")}),c(".addcart_close img").click(function(){c("#shopCartMessage").css("display","none")}),c("#show").css("background-image","url("+a.list[0].goodsimg+")"),c(".xzys dd ul").on("click","li",function(){c(this).attr("class","act").siblings().attr("class",""),c("#canshu").html(c(this).find("a").html())}),c("#buyNumDL").on("input",".count",function(){console.log(c(".count").val()),56<c(".count").val()?c(".count").val("56"):c(".count").val()<1&&c(".count").val("1")}),c("#buyNumDL").on("click",".c02",function(){c("#goodscount")[0].value++,56<c("#goodscount").val()&&c("#goodscount").val("56")}),c("#buyNumDL").on("click",".c01",function(){c("#goodscount")[0].value--,c("#goodscount").val()<1&&c("#goodscount").val("1")}),c("#xiao ul li").click(function(){var n=c(this).find("img").attr("src");console.log(n),c("#show").css("background-image","url("+n+")")}),c("#show").mouseover(function(){c("#rev").css("display","block"),c("#show1").css("display","block");var n=c(this).css("backgroundImage");c("#rev1").css("background",n+"0% 0% / cover no-repeat scroll padding-box border-box rgba(0, 0, 0, 0)")}),c("#show").mouseout(function(){c("#rev").css("display","none"),c("#show1").css("display","none")}),c("#prev").click(function(){var n=c("#picture #xiao ul li").size()-4,a=c("#picture #xiao ul").css("left").slice(0,1);console.log(a),a==75*-n+"px"||c("#picture #xiao ul").css("left",a-75)}),c("#next").click(function(){var n=c("#picture #xiao ul li").size()-4,a=c("#picture #xiao ul").css("left").slice(0,3);console.log(a),a==75*n||c("#picture #xiao ul").css("left",1*a+75)});var s=document.getElementById("show"),i=(document.getElementById("show1"),document.getElementById("pictrue"),document.getElementById("rev")),e=document.getElementById("rev1");s.onmousemove=function(n){console.log("x"),i.style.width=parseInt(s.offsetWidth/3)+"px",i.style.height=parseInt(s.offsetHeight/3)+"px";var a=n.pageX-160-i.offsetWidth/2,t=n.pageY-185-i.offsetHeight/2;a=(a=a<=0?0:a)>=s.offsetWidth-i.offsetWidth?s.offsetWidth-i.offsetWidth:a,t=(t=t<=0?0:t)>=s.offsetHeight-i.offsetHeight?s.offsetHeight-i.offsetHeight:t,i.style.left=a+"px",i.style.top=t+"px",e.style.width=3*s.offsetWidth+"px",e.style.height=3*s.offsetHeight+"px",e.style.marginLeft=-1*a*3+"px",e.style.marginTop=-1*t*3+"px"}})})});