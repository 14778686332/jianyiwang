"use strict";require.config({paths:{jquery:"../lib/js/jquery-1.10.1.min",common:"common"},shim:{}}),require(["jquery","common"],function(l){l(function(){if(getcookie("name")){var n=getcookie("name");l("#dengluhou").html("您好，"+n+"欢迎来到健一网网上药店!<a id='tc' href='../index1.html'>退出</a>")}else l("#dengluhou").html('欢迎来到健一网<h1>网上药店</h1>！[ <a href="login.html">登录</a> ] [ <a href="register.html">注册</a> ]');l("#tc").click(function(){removecookie("name"),location.href="../index1.html"}),getcookie("name")&&(l("#shopcart-con").remove(),l(".settlement").remove(),l.ajax({type:"get",url:"../api/08.cart.php",data:"username="+getcookie("name"),success:function(n){var s=JSON.parse(n);if(console.log(s),s.tiao){var a=function(){l(".shopcart-list .checkbox").each(function(n,a){l(a).prop("checked")&&s.push(n)});var a=0,i=0;s.forEach(function(n){a+=1*l(".countsa").eq(n).val(),i+=1*l(".goodsxinxi").eq(n).find(".zongji span").html()}),l("#allnum").html(a),l("#totalprice").html("￥"+i),s=[],console.log(a),console.log(i)};l("#shopcartMain").append('<div id="shopcart-con">\n                                    <ul class="shopcart-list">\n                                        <li class="clearfix">\n                                            <div class="biaoti" style="width:38%">商品名称</div>\n                                            <div class="biaoti" style="width:8%">货号</div>\n                                            <div class="biaoti" style="width:8%">商品规格</div>\n                                            <div class="biaoti" style="width:10%">生产厂家</div>\n                                            <div class="biaoti" style="width:8%">健一价</div>\n                                            <div class="biaoti" style="width:10%">数量</div>\n                                            <div class="biaoti" style="width:8%">商品合计</div>\n                                            <div class="biaoti" style="width:10%">操作</div>\n                                        </li>\n                                    </ul>\n                                </div>');var i=s.biao.map(function(n){return'<li class="goodsxinxi clearfix" data-id="'+n.huohao+'">\n                                    <div class="hezi shangming" style="width:38%">\n                                        <div class="xuankuang">\n                                            <input class="checkbox" type="checkbox" />\n                                        </div>\n                                        <div>\n                                            <img src="'+n.dimg+'" style="width:88px;height:88px;" />\n                                        </div>\n                                        <div class="wenzi">\n                                            <a href="###">\n                                                '+n.dgoodsname+'\n                                            </a>\n                                        </div>\n                                    </div>\n                                    <div class="hezi huohao" style="width:8%">\n                                        <span>'+n.huohao+'</span>\n                                    </div>\n                                    <div class="hezi guige" style="width:8%">\n                                        <span>\n                                            '+n.guige+'\n                                        </span>\n                                    </div>\n                                    <div class="hezi changjia" style="width:10%">\n                                        <span>'+n.changjia+'</span>\n                                    </div>\n                                    <div class="hezi dmoney" style="width:8%">\n                                        <span>'+n.dmoney+'.00</span>\n                                    </div>\n                                    <div class="hezi shuliang" style="width:10%">\n                                        <span>\n                                           <a data-id="'+n.huohao+'" href="###" class="cutnum">-</a>\n                                            <input data-id="'+n.huohao+'" type="text" class="countsa" value="'+n.counts+'"/>\n                                            <a data-id="'+n.huohao+'" href="###" class="addnum">+</a> \n                                        </span>\n                                        \n                                    </div>\n                                    <div class="hezi zongji" style="width:8%">\n                                        <span>\n                                            28.00\n                                        </span>\n                                    </div>\n                                    <div class="hezi caozuo" style="width:8%">\n                                            <a data-id="'+n.huohao+'" class="shanchu" href="###">删除</a>\n                                    </div>\n                                </li>'});l(".shopcart-list").append(i),l("#shopcartMain").append('<div class="settlement">\n                            <ul class="fl">\n                                <li class="choice">\n                                    <label for="checkAll">\n                                        <input name="all" id="checkAll" type="checkbox">\n                                        <span class="plr5">全选</span>\n                                    </label>\n                                    <a id="delall" href="###">批量删除</a>\n                                    <a href="goodslist.html" class="fc9">&lt;&lt;继续购物</a>\n\n                                </li>\n                            </ul>\n                            <ul class="fr">\n                                <li class="lh47">\n                                    <span class="pr20">已选择<i id="allnum">0</i>件商品</span>\n                                    <span class="pr20">总价（不包含运费）：<strong id="totalprice">￥0.00</strong></span>\n                                </li>\n                                <li>\n                                    <input type="button" class="btn-set" value="去结算">\n                                </li>\n                            </ul>\n                        </div>');for(var t=0;t<l(".shopcart-list .goodsxinxi").size();t++){var e=l(".shopcart-list .goodsxinxi").eq(t).find(".dmoney span").html()*l(".shopcart-list .goodsxinxi").eq(t).find(".countsa").val();l(".shopcart-list .goodsxinxi").eq(t).find(".zongji span").html(e+".00")}l(".addnum").click(function(){var n=l(this).prev().val();n++,l(this).prev().val(n),l(this).parent().parent().next().find("span").html(l(this).parent().parent().prev().find("span").html()*n+".00"),l.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+l(this).attr("data-id")+"&vall="+n,success:function(n){console.log(n)}}),a()}),l(".cutnum").click(function(){var n=l(this).next().val();--n<=1&&(n=1),l(this).next().val(n),l(this).parent().parent().next().find("span").html(l(this).parent().parent().prev().find("span").html()*n+".00"),l.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+l(this).attr("data-id")+"&vall="+n,success:function(n){console.log(n)}}),a()}),l(".countsa").blur(function(){l(this).parent().parent().next().find("span").html(l(this).parent().parent().prev().find("span").html()*l(this).val()+".00"),l.ajax({type:"get",url:"../api/index2.php",data:"username="+getcookie("name")+"&huohao="+l(this).attr("data-id")+"&vall="+l(this).val(),success:function(n){console.log(n)}}),a()}),l(".shanchu").click(function(){l(this).parent().parent().remove(),l.ajax({type:"get",url:"../api/indexdel.php",data:"username="+getcookie("name")+"&huohao="+l(this).attr("data-id"),success:function(n){if(0==n){l("#shopcartMain").append('<div class="nogoods clearfix">\n                                                        <div class="nogoods_l fl">\n                                                            <img src="https://img.j1.com/images/nogoods.jpg" alt="购物车是空的" width="74" height="77">\n                                                        </div>\n                                                        <div class="nogoods_r fl">\n                                                            <strong>您的购物车还是空的。</strong><br>\n                                                            您还没有添加任何商品。马上去[<a class="sediao" href="goodslist.html">挑选商品</a>]\n                                                        </div>\n                                                    </div>'),l("#shopcart-con").remove(),l(".settlement").remove()}}})}),l("#checkAll").click(function(){var n=l(this).prop("checked");l(".shopcart-list .checkbox").prop("checked",n),a()}),l(".shopcart-list .checkbox").click(function(){l(".shopcart-list .checkbox:checked").size()==l(".shopcart-list .checkbox").size()?l("#checkAll").prop("checked",!0):l("#checkAll").prop("checked",!1),a()});s=[];l("#delall").click(function(){console.log("x");var i=[];if(l(".shopcart-list .checkbox").each(function(n,a){l(a).prop("checked")&&i.push(n)}),console.log(i),confirm("您确定要全删吗？")){for(var n=i.length-1;0<=n;n--)l.ajax({type:"get",url:"../api/indexdel.php",data:"username="+getcookie("name")+"&huohao="+l(".goodsxinxi").eq(i[n]).attr("data-id"),success:function(n){if(0==n){l("#shopcartMain").append('<div class="nogoods clearfix">\n                                                            <div class="nogoods_l fl">\n                                                                <img src="https://img.j1.com/images/nogoods.jpg" alt="购物车是空的" width="74" height="77">\n                                                            </div>\n                                                            <div class="nogoods_r fl">\n                                                                <strong>您的购物车还是空的。</strong><br>\n                                                                您还没有添加任何商品。马上去[<a class="sediao" href="goodslist.html">挑选商品</a>]\n                                                            </div>\n                                                        </div>'),l("#shopcart-con").remove(),l(".settlement").remove()}}}),l(".goodsxinxi").eq(i[n]).remove();a()}})}else{var o='<div class="nogoods clearfix">\n                                    <div class="nogoods_l fl">\n                                        <img src="https://img.j1.com/images/nogoods.jpg" alt="购物车是空的" width="74" height="77">\n                                    </div>\n                                    <div class="nogoods_r fl">\n                                        <strong>您的购物车还是空的。</strong><br>\n                                        您还没有添加任何商品。马上去[<a class="sediao" href="goodslist.html">挑选商品</a>]\n                                    </div>\n                                </div>';console.log(o),l("#shopcartMain").append(o)}}}))})});